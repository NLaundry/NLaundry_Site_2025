---
import { GLOBAL } from "../lib/variables";
import Anchor from "./common/Anchor.astro";
import ThemeToggle from "./ThemeToggle.astro";
---

<header class="sticky top-0 z-50 backdrop-blur-md bg-base-100/80 border-b border-base-300">
  <div class="max-w-4xl mx-auto px-4 py-4 flex justify-between items-center">
    <div class="flex items-center space-x-8">
      <a href="/" class="text-xl font-display font-bold text-primary hover:text-primary/80 transition-colors">
        {GLOBAL.username}
      </a>
      <div class="hidden sm:flex space-x-6">
        {Object.entries(GLOBAL.menu).map(([name, url]) => (
          <Anchor url={url} class="text-base-content/70 hover:text-primary transition-colors font-medium">
            {name}
          </Anchor>
        ))}
      </div>
    </div>
    
    <div class="flex items-center space-x-4">
      {GLOBAL.githubProfile && (
        <Anchor url={GLOBAL.githubProfile} class="p-2 rounded-lg hover:bg-base-200 transition-colors" aria-label="GitHub Profile">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            class="fill-current"
          >
            <path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5c.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34c-.46-1.16-1.11-1.47-1.11-1.47c-.91-.62.07-.6.07-.6c1 .07 1.53 1.03 1.53 1.03c.87 1.52 2.34 1.07 2.91.83c.09-.65.35-1.09.63-1.34c-2.22-.25-4.55-1.11-4.55-4.92c0-1.11.38-2 1.03-2.71c-.1-.25-.45-1.29.1-2.64c0 0 .84-.27 2.75 1.02c.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02c.55 1.35.2 2.39.1 2.64c.65.71 1.03 1.6 1.03 2.71c0 3.82-2.34 4.66-4.57 4.91c.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"></path>
          </svg>
        </Anchor>
      )}
      {GLOBAL.substackProfile && (
        <Anchor url={GLOBAL.substackProfile} class="p-2 rounded-lg hover:bg-base-200 transition-colors" aria-label="Substack Newsletter">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            class="fill-current"
          >
            <path d="M22.539 8.242H1.46V5.406h21.08v2.836zM1.46 10.812V24L12 18.11 22.54 24V10.812H1.46zM22.54 0H1.46v2.836h21.08V0z"/>
          </svg>
        </Anchor>
      )}
      {GLOBAL.youtubeProfile && (
        <Anchor url={GLOBAL.youtubeProfile} class="p-2 rounded-lg hover:bg-base-200 transition-colors" aria-label="YouTube Channel">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            class="fill-current"
          >
            <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"></path>
          </svg>
        </Anchor>
      )}
      <!-- <ThemeToggle /> -->
    </div>
  </div>
</header>

<script>
  const button = document.querySelector("button");
  const nav = document.querySelector("nav");
  let isOpen = false;

  function updateNavState() {
    const isMobile = window.matchMedia("(max-width: 640px)").matches;
    if (isMobile) {
      nav!.style.transform = isOpen ? "translateY(0)" : "translateY(-100%)";
    } else {
      nav!.style.transform = "translateY(0)";
      isOpen = false;
    }
  }

  function toggleNav() {
    isOpen = !isOpen;
    updateNavState();
  }

  button?.addEventListener("click", toggleNav);
  window.addEventListener("resize", updateNavState);

  updateNavState();
</script>
